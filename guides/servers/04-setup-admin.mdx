---
title: "Admin-server setup"
description: "Create server-level Git repository and Admin-Server directory structure for scripts and config."
sidebarTitle: "4. Setup admin"
icon: "folder"
---

Initialize a Git repository in the server home directory and create the **Admin-Server** folder structure for deployment scripts and configuration. This gives you version-controlled server setup and a single place for universal management scripts.

<Info>
**Time estimate:** ~30 minutes. **Result:** Server config is in Git on GitHub; Admin-Server is ready for scripts and config files.
</Info>

## Prerequisites

- **A3 GitHub authentication** done: server can run `ssh -T git@github.com` successfully
- You are connected to the server (e.g. via VSCode Remote)

<Steps>
  <Step title="Initialize server-level Git repository">
    1. Change to the home directory.
    2. Initialize Git and configure local user settings.
    3. Verify the configuration.

    ```bash
    cd ~
    git init
    ```

    ```bash
    git config user.email "server@yourdomain.com"
    git config user.name "Server"
    git config pull.rebase false
    # Expected: no output on success
    ```

    ```bash
    git config --list --local
    ```

    ```
    core.repositoryformatversion=0
    user.email=server@yourdomain.com
    user.name=Server
    pull.rebase=false
    # Expected: local config shows your email, name, and pull.rebase
    ```

    <Check>Git initialized in home directory.</Check>
  </Step>

  <Step title="Create server .gitignore">
    1. Create the `.gitignore` file with domain directories, temp files, secrets, and system exclusions.
    2. Verify the file was created.

    ```bash
    cat > ~/.gitignore << 'EOF'
# Domain directories (each project has its own repo)
domains/
public_html/

# Temp, logs, cache
*.tmp *.temp *.swp *~
*.log error_log access_log logs/
.cache/ cache/ tmp/

# Database backups and large files
*.sql *.sql.gz backup-*.sql
*.zip *.tar.gz *.tar.bz2

# Private / sensitive
.env .env.*
.ssh/id_* .ssh/*_key .ssh/*_key.pub
.ssh/authorized_keys .ssh/known_hosts
.my.cnf .msmtprc

# IDE / editor
.vscode-server/ .vscode-server-insiders/ .cursor-server/ .cursor/

# System / host-specific
.DS_Store Thumbs.db
.cagefs/ .cl.selector/ .cpanel/
node_modules/ vendor/
EOF
    ```

    <Note>This excludes domain directories (each project has its own repo), excludes sensitive files, and allows Admin-Server to be tracked.</Note>

    ```bash
    cat ~/.gitignore | head -20
    # Expected: first 20 lines of .gitignore displayed
    ```

    <Check>.gitignore created.</Check>
  </Step>

  <Step title="Create server README">
    1. Create a README that documents server purpose, contents, and structure.
    2. Include the quick restore command for new servers.

    ```bash
    cat > ~/README.md << 'EOF'
# Server configuration

**Purpose:** Server configuration, scripts, and management tools.

## Contents

- **Admin-Server/** — Deployment and management scripts
- Server config files (e.g. `.gitconfig`, `.ssh/config`)

## Directory structure

    ~/
    ├── Admin-Server/{scripts,config,docs,logs}
    ├── domains/         # Per-project (each has own repo)
    └── .gitignore

**Domains:** Each project manages its own repo. Admin-Server scripts handle detection and tracking.

## Quick restore

Clone this repo to a new server and run Admin-Server scripts as needed.
EOF
    ```

    <Check>README created.</Check>
  </Step>

  <Step title="Create initial commit">
    1. Stage the config files.
    2. Create the first commit.

    ```bash
    git add .gitignore README.md
    git status
    # Expected: .gitignore and README.md listed as new files
    ```

    ```bash
    git commit -m "Initial server config: .gitignore, README"
    # Expected: 1 file changed, 2 insertions(+); or similar
    ```

    <Check>First commit created.</Check>
  </Step>

  <Step title="Create GitHub repository">
    1. Create a new repository on GitHub.
    2. Do **not** check any initialization options — already created locally.

    <Tabs>
      <Tab title="Web UI">
        Go to [github.com/new](https://github.com/new). **Name:** `Server-YourHosting-Name`. **Visibility:** Private. Leave init options unchecked. Click **Create repository**.
      </Tab>
      <Tab title="GitHub CLI">
        Run from server home: `gh repo create Server-YourHosting-Name --private --source=. --remote=origin --push`
      </Tab>
    </Tabs>

    <Warning>Server configuration should NOT be in a public repo. Use **Private** visibility.</Warning>

    <Check>Empty GitHub repo created.</Check>
  </Step>

  <Step title="Connect and push to GitHub">
    1. Add the remote origin.
    2. Rename branch to main and push.

    <CodeGroup>
    ```bash Add remote
    git remote add origin git@github.com:YOUR_USERNAME/YOUR_REPO.git
    # Replace placeholders; expected: no output on success
    ```

    ```bash Verify remote
    git remote -v
    # Expected: origin  git@github.com:YOUR_USERNAME/YOUR_REPO.git (fetch) (push)
    ```
    </CodeGroup>

    ```bash
    git branch -M main
    git push -u origin main
    # Expected: Enumerating objects... Writing objects... branch 'main' set up to track 'origin/main'
    ```

    Verify on GitHub: refresh the repo page. You should see README and .gitignore.

    <Check>Server config synced to GitHub.</Check>
  </Step>

  <Step title="Create Admin-Server directory structure">
    1. Create the directory structure.
    2. Create config files with placeholder format.
    3. Create placeholder scripts and make them executable.

    ```bash
    mkdir -p ~/Admin-Server/{scripts,config,docs,logs}
    ```

    ```bash
    cat > ~/Admin-Server/config/tracked-domains.conf << 'EOF'
# Format: domain_path|github_repo|detection_interval
# Example: /home/user/domains/example.com|user/example-repo|60
EOF
    ```

    ```bash
    cat > ~/Admin-Server/config/binary-paths.conf << 'EOF'
# PHP_PATH=
# COMPOSER_PATH=
# NPM_PATH=
EOF
    ```

    ```bash
    cd ~/Admin-Server/scripts
    touch detect-domain-changes.sh setup-domain-tracking.sh check-tracking-status.sh
    chmod +x *.sh
    ls -la
    # Expected: -rwxr-xr-x for each .sh file
    ```

    <Note>**scripts/** — universal management scripts; **config/** — settings; **docs/** — documentation; **logs/** — script output.</Note>

    <Check>Admin-Server structure created.</Check>
  </Step>

  <Step title="Create Admin-Server README">
    1. Document the Admin-Server purpose and structure.
    2. Include quick start commands and configuration format.

    ```bash
    cat > ~/Admin-Server/README.md << 'ENDOFFILE'
# Admin-Server — Server-wide tools for domain tracking and deployment.

**Structure:** scripts/, config/, docs/, logs/
**Config:** tracked-domains.conf (`domain_path|github_repo|interval`), binary-paths.conf (PHP, Composer, NPM)
**Logs:** Script output in logs/
ENDOFFILE
    ```

    <Check>Admin-Server documented.</Check>
  </Step>

  <Step title="Commit and push Admin-Server">
    1. Stage the Admin-Server directory.
    2. Commit and push to GitHub.

    ```bash
    cd ~
    git add Admin-Server/
    git status
    # Expected: Admin-Server/ listed as new files
    ```

    ```bash
    git commit -m "Add Admin-Server structure, config, and scripts"
    git push origin main
    # Expected: remote: Resolving deltas... To github.com:user/repo.git
    ```

    <Check>Admin-Server on GitHub.</Check>
  </Step>
</Steps>

## Verification checklist

- [ ] Git initialized in home directory
- [ ] .gitignore excludes domains, secrets, temp files
- [ ] README documents server purpose and structure
- [ ] GitHub repo exists (private)
- [ ] Admin-Server has scripts/, config/, docs/, logs/
- [ ] tracked-domains.conf and binary-paths.conf exist
- [ ] Placeholder scripts are executable

## Troubleshooting

<AccordionGroup>
  <Accordion title="git push rejected">
    - Check the remote URL: `git remote -v`
    - Ensure the repo is empty on GitHub (no README/license added during creation)
    - For first push only when the remote has conflicting content: `git push -u origin main --force`

    <Danger>`--force` overwrites remote history. Use only on first push to an empty repo or when you intend to replace remote content.</Danger>
  </Accordion>
  <Accordion title="Permission denied on push">
    - Verify GitHub authentication: `ssh -T git@github.com`
    - Ensure remote URL uses SSH (`git@github.com:...`) not HTTPS (`https://github.com/...`)
  </Accordion>
</AccordionGroup>

## Next step

<Card title="5. Binary path discovery" icon="search" href="/guides/servers/05-discover-paths">
  Find PHP, Composer, and NPM paths and document them for deploy scripts.
</Card>
